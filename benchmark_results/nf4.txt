 INFO Compiling packages
 INFO compile{package=gleam_stdlib}: analysing_modules count=0
 INFO compile{package=gleamy_bench}: analysing_modules count=0
 INFO compile{package=gleeunit}: analysing_modules count=0
warning: Unused imported type
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/auto_tune.gleam:17:22
   │
17 │ import gleam/option.{type Option, None, Some}
   │                      ^^^^^^^^^^^ This imported type is never used

Hint: You can safely remove it.

warning: Unused imported item
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/auto_tune.gleam:17:35
   │
17 │ import gleam/option.{type Option, None, Some}
   │                                   ^^^^ This imported constructor is never used

Hint: You can safely remove it.

warning: Unused imported item
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/auto_tune.gleam:17:41
   │
17 │ import gleam/option.{type Option, None, Some}
   │                                         ^^^^ This imported constructor is never used

Hint: You can safely remove it.

warning: Unused imported module
  ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/bench.gleam:5:1
  │
5 │ import gleam/float
  │ ^^^^^^^^^^^^^^^^^^ This imported module is never used

Hint: You can safely remove it.

warning: Unused imported module
  ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/bench_gpu.gleam:9:1
  │
9 │ import gleam/result
  │ ^^^^^^^^^^^^^^^^^^^ This imported module is never used

Hint: You can safely remove it.

warning: Unused private function
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/bench_gpu.gleam:14:1
   │
14 │ fn glands_check() -> String
   │ ^^^^^^^^^^^^^^^^^ This private function is never used

Hint: You can safely remove it.

warning: Unused private function
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/bench_gpu.gleam:17:1
   │
17 │ fn glands_init_ffi(config: GlandsConfig) -> Result(GlandsHandle, String)
   │ ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ This private function is never used

Hint: You can safely remove it.

warning: Unused private function
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/bench_gpu.gleam:20:1
   │  
20 │ ╭ fn glands_similarity_ffi(
21 │ │   handle: GlandsHandle,
22 │ │   a: List(Float),
23 │ │   b: List(Float),
24 │ │ ) -> Result(Float, String)
   │ ╰─^ This private function is never used

Hint: You can safely remove it.

warning: Unused private function
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/bench_gpu.gleam:27:1
   │  
27 │ ╭ fn glands_bind_ffi(
28 │ │   handle: GlandsHandle,
29 │ │   a: List(Float),
30 │ │   b: List(Float),
31 │ │ ) -> Result(List(Float), String)
   │ ╰─^ This private function is never used

Hint: You can safely remove it.

warning: Unused private type
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/bench_gpu.gleam:36:1
   │
36 │ type GlandsConfig {
   │ ^^^^^^^^^^^^^^^^^ This private type is never used

Hint: You can safely remove it.

warning: Unused private constructor
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/bench_gpu.gleam:37:3
   │
37 │   GlandsConfig(hrr_dim: Int, llm_dim: Int, seed: Int)
   │   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ This private constructor is never used

Hint: You can safely remove it.

warning: Unused private type
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/bench_gpu.gleam:40:1
   │
40 │ type GlandsHandle
   │ ^^^^^^^^^^^^^^^^^ This private type is never used

Hint: You can safely remove it.

warning: Unused imported type
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/blackwell.gleam:27:22
   │
27 │ import gleam/option.{type Option, None, Some}
   │                      ^^^^^^^^^^^ This imported type is never used

Hint: You can safely remove it.

warning: Unused imported item
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/blackwell.gleam:27:35
   │
27 │ import gleam/option.{type Option, None, Some}
   │                                   ^^^^ This imported constructor is never used

Hint: You can safely remove it.

warning: Unused imported item
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/blackwell.gleam:27:41
   │
27 │ import gleam/option.{type Option, None, Some}
   │                                         ^^^^ This imported constructor is never used

Hint: You can safely remove it.

warning: Inefficient use of `list.length`
    ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/blackwell.gleam:248:25
    │
248 │   let mean_error = case list.length(errors) > 0 {
    │                         ^^^^^^^^^^^^^^^^^^^^^^^

The `list.length` function has to iterate across the whole
list to calculate the length, which is wasteful if you only
need to know if the list is empty or not.

Hint: You can use `the_list != []` instead.

warning: Unused imported item
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/rtx4090.gleam:25:41
   │
25 │ import viva_tensor/tensor.{type Tensor, Tensor}
   │                                         ^^^^^^ This imported constructor is never used

Hint: You can safely remove it.

warning: Unused imported type
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/rtx4090.gleam:27:25
   │
27 │   type BlackwellTensor, type CompressionConfig, type CompressionStats,
   │                         ^^^^^^^^^^^^^^^^^^^^^^ This imported type is never used

Hint: You can safely remove it.

warning: Unused imported type
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/rtx4090.gleam:27:49
   │
27 │   type BlackwellTensor, type CompressionConfig, type CompressionStats,
   │                                                 ^^^^^^^^^^^^^^^^^^^^^ This imported type is never used

Hint: You can safely remove it.

warning: Unused imported value
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/rtx4090.gleam:28:13
   │
28 │   compress, compression_stats, decompress, nvfp4_config, int8_config,
   │             ^^^^^^^^^^^^^^^^^ This imported value is never used

Hint: You can safely remove it.

warning: Unused imported value
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/rtx4090.gleam:28:32
   │
28 │   compress, compression_stats, decompress, nvfp4_config, int8_config,
   │                                ^^^^^^^^^^ This imported value is never used

Hint: You can safely remove it.

warning: Unused variable
    ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/rtx4090.gleam:119:7
    │
119 │   let specs = get_specs()
    │       ^^^^^ This variable is never used

Hint: You can ignore it with an underscore: `_specs`.

  Compiling viva_tensor
 INFO compile{package=viva_tensor}: analysing_modules count=1
{compiling,"/home/mrootx/viva_gleam/repos/viva_tensor/build/dev/erlang/viva_tensor/_gleam_artefacts/viva_tensor@nf4.erl"}
{compiled,viva_tensor@nf4,
          "/home/mrootx/viva_gleam/repos/viva_tensor/build/dev/erlang/viva_tensor/ebin/viva_tensor@nf4.beam"}
   Compiled in 0.39s
    Running viva_tensor/nf4.main
╔══════════════════════════════════════════════════════════════════╗
║  NF4 (NormalFloat4) QUANTIZATION - QLoRA Style                   ║
║  8x compressão com distribuição gaussiana otimizada!             ║
╚══════════════════════════════════════════════════════════════════╝

NÍVEIS NF4 (16 quantis da distribuição normal):
  [0]: -1.0
  [1]: -0.6962
  [2]: -0.5251
  [3]: -0.3949
  [4]: -0.2844
  [5]: -0.1848
  [6]: -0.0911
  [7]: 0.0
  [8]: 0.0796
  [9]: 0.1609
  [10]: 0.2461
  [11]: 0.3379
  [12]: 0.4407
  [13]: 0.5626
  [14]: 0.723
  [15]: 1.0

━━━ BENCHMARK: Tensor 1024x512 ━━━

NF4 Quantization:
  Tempo:       300ms
  Original:    2048 KB
  Comprimido:  272 KB
  Compressão:  7.5294x
  Erro médio:  0.0379
  Erro máx:    0.1384
  Blocos:      8192

━━━ DOUBLE QUANTIZATION (reduz overhead de metadados) ━━━
  Tempo:       286ms
  Comprimido:  264 KB
  Compressão:  7.7575x

━━━ COMPARAÇÃO DE FORMATOS ━━━
  FP32:  2048 KB (1x)
  FP16:  1024 KB (2x)
  INT8:  512 KB (4x)
  NF4:   272 KB (7.5294x)
  NF4+DQ: 264 KB (7.7575x)

╔══════════════════════════════════════════════════════════════════╗
║  POR QUE NF4 É MELHOR QUE Q4 UNIFORME:                           ║
║                                                                  ║
║  1. Níveis derivados da distribuição normal                      ║
║  2. Mais precisão próximo de zero (onde concentram pesos)        ║
║  3. Matematicamente ótimo para dados gaussianos                  ║
║  4. Usado em QLoRA, bitsandbytes, Hugging Face                   ║
║                                                                  ║
║  Com NF4: 24GB VRAM → ~192GB efetivo (8x)!                       ║
╚══════════════════════════════════════════════════════════════════╝
