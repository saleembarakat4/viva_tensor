 INFO Compiling packages
 INFO compile{package=gleam_stdlib}: analysing_modules count=0
 INFO compile{package=gleamy_bench}: analysing_modules count=0
 INFO compile{package=gleeunit}: analysing_modules count=0
warning: Unused imported type
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/auto_tune.gleam:17:22
   │
17 │ import gleam/option.{type Option, None, Some}
   │                      ^^^^^^^^^^^ This imported type is never used

Hint: You can safely remove it.

warning: Unused imported item
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/auto_tune.gleam:17:35
   │
17 │ import gleam/option.{type Option, None, Some}
   │                                   ^^^^ This imported constructor is never used

Hint: You can safely remove it.

warning: Unused imported item
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/auto_tune.gleam:17:41
   │
17 │ import gleam/option.{type Option, None, Some}
   │                                         ^^^^ This imported constructor is never used

Hint: You can safely remove it.

warning: Unused imported module
  ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/bench.gleam:5:1
  │
5 │ import gleam/float
  │ ^^^^^^^^^^^^^^^^^^ This imported module is never used

Hint: You can safely remove it.

warning: Unused imported module
  ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/bench_gpu.gleam:9:1
  │
9 │ import gleam/result
  │ ^^^^^^^^^^^^^^^^^^^ This imported module is never used

Hint: You can safely remove it.

warning: Unused private function
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/bench_gpu.gleam:14:1
   │
14 │ fn glands_check() -> String
   │ ^^^^^^^^^^^^^^^^^ This private function is never used

Hint: You can safely remove it.

warning: Unused private function
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/bench_gpu.gleam:17:1
   │
17 │ fn glands_init_ffi(config: GlandsConfig) -> Result(GlandsHandle, String)
   │ ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ This private function is never used

Hint: You can safely remove it.

warning: Unused private function
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/bench_gpu.gleam:20:1
   │  
20 │ ╭ fn glands_similarity_ffi(
21 │ │   handle: GlandsHandle,
22 │ │   a: List(Float),
23 │ │   b: List(Float),
24 │ │ ) -> Result(Float, String)
   │ ╰─^ This private function is never used

Hint: You can safely remove it.

warning: Unused private function
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/bench_gpu.gleam:27:1
   │  
27 │ ╭ fn glands_bind_ffi(
28 │ │   handle: GlandsHandle,
29 │ │   a: List(Float),
30 │ │   b: List(Float),
31 │ │ ) -> Result(List(Float), String)
   │ ╰─^ This private function is never used

Hint: You can safely remove it.

warning: Unused private type
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/bench_gpu.gleam:36:1
   │
36 │ type GlandsConfig {
   │ ^^^^^^^^^^^^^^^^^ This private type is never used

Hint: You can safely remove it.

warning: Unused private constructor
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/bench_gpu.gleam:37:3
   │
37 │   GlandsConfig(hrr_dim: Int, llm_dim: Int, seed: Int)
   │   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^ This private constructor is never used

Hint: You can safely remove it.

warning: Unused private type
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/bench_gpu.gleam:40:1
   │
40 │ type GlandsHandle
   │ ^^^^^^^^^^^^^^^^^ This private type is never used

Hint: You can safely remove it.

warning: Unused imported type
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/blackwell.gleam:27:22
   │
27 │ import gleam/option.{type Option, None, Some}
   │                      ^^^^^^^^^^^ This imported type is never used

Hint: You can safely remove it.

warning: Unused imported item
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/blackwell.gleam:27:35
   │
27 │ import gleam/option.{type Option, None, Some}
   │                                   ^^^^ This imported constructor is never used

Hint: You can safely remove it.

warning: Unused imported item
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/blackwell.gleam:27:41
   │
27 │ import gleam/option.{type Option, None, Some}
   │                                         ^^^^ This imported constructor is never used

Hint: You can safely remove it.

warning: Inefficient use of `list.length`
    ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/blackwell.gleam:248:25
    │
248 │   let mean_error = case list.length(errors) > 0 {
    │                         ^^^^^^^^^^^^^^^^^^^^^^^

The `list.length` function has to iterate across the whole
list to calculate the length, which is wasteful if you only
need to know if the list is empty or not.

Hint: You can use `the_list != []` instead.

warning: Unused imported item
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/rtx4090.gleam:25:41
   │
25 │ import viva_tensor/tensor.{type Tensor, Tensor}
   │                                         ^^^^^^ This imported constructor is never used

Hint: You can safely remove it.

warning: Unused imported type
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/rtx4090.gleam:27:25
   │
27 │   type BlackwellTensor, type CompressionConfig, type CompressionStats,
   │                         ^^^^^^^^^^^^^^^^^^^^^^ This imported type is never used

Hint: You can safely remove it.

warning: Unused imported type
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/rtx4090.gleam:27:49
   │
27 │   type BlackwellTensor, type CompressionConfig, type CompressionStats,
   │                                                 ^^^^^^^^^^^^^^^^^^^^^ This imported type is never used

Hint: You can safely remove it.

warning: Unused imported value
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/rtx4090.gleam:28:13
   │
28 │   compress, compression_stats, decompress, nvfp4_config, int8_config,
   │             ^^^^^^^^^^^^^^^^^ This imported value is never used

Hint: You can safely remove it.

warning: Unused imported value
   ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/rtx4090.gleam:28:32
   │
28 │   compress, compression_stats, decompress, nvfp4_config, int8_config,
   │                                ^^^^^^^^^^ This imported value is never used

Hint: You can safely remove it.

warning: Unused variable
    ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/rtx4090.gleam:119:7
    │
119 │   let specs = get_specs()
    │       ^^^^^ This variable is never used

Hint: You can ignore it with an underscore: `_specs`.

  Compiling viva_tensor
 INFO compile{package=viva_tensor}: analysing_modules count=1
warning: Unused variable
    ┌─ /home/mrootx/viva_gleam/repos/viva_tensor/src/viva_tensor/awq.gleam:177:9
    │
177 │   let #(out_features, in_features) = case shape {
    │         ^^^^^^^^^^^^ This variable is never used

Hint: You can ignore it with an underscore: `_out_features`.

{compiling,"/home/mrootx/viva_gleam/repos/viva_tensor/build/dev/erlang/viva_tensor/_gleam_artefacts/viva_tensor@awq.erl"}
{compiled,viva_tensor@awq,
          "/home/mrootx/viva_gleam/repos/viva_tensor/build/dev/erlang/viva_tensor/ebin/viva_tensor@awq.beam"}
   Compiled in 0.34s
    Running viva_tensor/awq.main
╔══════════════════════════════════════════════════════════════════╗
║  AWQ (Activation-aware Weight Quantization)                      ║
║  MLSys 2024 BEST PAPER AWARD!                                    ║
╚══════════════════════════════════════════════════════════════════╝

CONCEITO:
  - Apenas ~1% dos pesos são 'salientes'
  - Identificados pela magnitude das ATIVAÇÕES, não dos pesos!
  - Escalar canais salientes PARA CIMA antes de quantizar
  - Matematicamente equivalente: W*X = (sW)*(X/s)

━━━ CALIBRAÇÃO ━━━
  Amostras de calibração: 100
  Features por amostra: 256
  Canais salientes (top 1%): 3
  Top 5 canais mais salientes:
    Canal 97: 0.5874
    Canal 11: 0.5632
    Canal 89: 0.5626

━━━ AWQ QUANTIZATION ━━━
  Tempo:       198ms
  Original:    512 KB
  Comprimido:  66 KB
  Compressão:  7.6992x

━━━ VERIFICAÇÃO DE ERRO ━━━
  Erro médio: 0.0363
  Erro máx:   0.0807

━━━ COMPARAÇÃO: AWQ vs Quantização Normal ━━━
  AWQ reduz erro em canais salientes (~1% dos pesos)
  Esses canais têm MAIOR impacto na saída
  Resultado: mesma compressão, MUITO menos perda de qualidade

╔══════════════════════════════════════════════════════════════════╗
║  POR QUE AWQ VENCEU O MLSYS 2024:                                ║
║                                                                  ║
║  1. Insight simples mas poderoso: foca nas ativações             ║
║  2. Zero custo em runtime (transformação pré-computada)          ║
║  3. Funciona com qualquer quantização (INT4, INT8, NF4)          ║
║  4. Estado da arte em LLMs quantizados                           ║
║                                                                  ║
║  viva_tensor + AWQ = Máxima precisão com 8x compressão!          ║
╚══════════════════════════════════════════════════════════════════╝
